(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{34:(e,t,n)=>{Promise.resolve().then(n.bind(n,5558))},5558:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>N});var l=n(5155),i=n(2115);let r=function(){for(var e,t,n=0,l="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=function e(t){var n,l,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var r=t.length;for(n=0;n<r;n++)t[n]&&(l=e(t[n]))&&(i&&(i+=" "),i+=l)}else for(l in t)t[l]&&(i&&(i+=" "),i+=l);return i}(e))&&(l&&(l+=" "),l+=t);return l},s={src:"/minesweeper/_next/static/media/bomb.ffc243c2.svg"},a={src:"/minesweeper/_next/static/media/redFlag.1b491fbe.png"},o=[null,"text-[blue]","text-[green]","text-[tomato]","text-[darkviolet]","text-[darkred]","text-[steelblue]","text-[black]","text-[black]"],c=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],u={easy:{rows:9,cols:9,totalMines:10},medium:{rows:16,cols:16,totalMines:40},expert:{rows:16,cols:30,totalMines:99}},f="easy",d={REVEAL_EMPTY:"reveal_empty.wav",REVEAL_NUMBER:"reveal_number.wav",FLAG_PLACE:"flag_place.wav",FLAG_REMOVE:"flag_remove.wav",GAME_OVER:"game_over.wav",GAME_WIN:"game_win.wav"};function m(e){let{cell:t,rowIndex:n,colIndex:i,level:c,handleCellLeftClick:u,handleCellRightClick:f}=e;return(0,l.jsxs)("div",{className:r("w-9 h-9 border-1 border-zinc-600 flex justify-center items-center text-2xl font-bold cursor-default relative","number"==typeof t.value&&o[t.value],!t.isOpened&&"bg-[#ccc] border-3 border-t-[#eee] border-l-[#eee] border-r-[#aaa] border-b-[#aaa] shadow-sm","mine"===t.value&&t.hightlight,"easy"===c&&"w-16 h-16 text-4xl",!t.isOpened&&"cursor-pointer"),onClick:()=>u(n,i),onContextMenu:e=>f(e,n,i),children:[t.isOpened&&"number"==typeof t.value&&t.value||"",t.isOpened&&"mine"===t.value&&(0,l.jsx)("img",{className:"w-[80%] h-[80%]",src:s.src}),t.isFlagged&&(0,l.jsx)("img",{className:"w-[80%] h-[80%]",src:a.src})]})}function g(e){let{board:t,level:n,handleCellLeftClick:i,handleCellRightClick:r}=e,s=0;return(0,l.jsx)("div",{children:t.map((e,t)=>(s++,(0,l.jsx)("div",{className:"flex",children:e.map((e,a)=>(s++,(0,l.jsx)(m,{cell:e,handleCellLeftClick:i,handleCellRightClick:r,rowIndex:t,colIndex:a,level:n},s)))},s)))})}function h(e){return JSON.parse(JSON.stringify(e))}function x(){return performance.now()/1e3}function v(e){return Math.floor(Math.random()*e)}function p(e,t,n){let l=function(e,t){let n=[];for(let l=0;l<e;l++){n[l]=[];for(let e=0;e<t;e++)n[l][e]={value:null,isFlagged:!1,isOpened:!1}}return n}(e,t);for(let i=0;i<n;){let n=v(e),r=v(t);"mine"!==l[n][r].value&&(l[n][r].value="mine",i++)}return l.forEach((e,t)=>{e.forEach((n,i)=>{if("mine"!==n.value){let r=0;c.forEach(n=>{let[s,a]=n,o=t+s,c=i+a;o in l&&c in e&&"mine"===l[o][c].value&&r++}),r>0&&(n.value=r)}})}),l}function b(e,t){for(let n of e)for(let e of n)"mine"===e.value&&(e.isOpened=!0,t&&(e.hightlight="bg-[green]"))}function w(e){let{level:t,setLevel:n}=e;return(0,l.jsx)("ul",{className:"flex justify-around",children:Object.keys(u).map(e=>(0,l.jsx)("li",{children:(0,l.jsx)("button",{className:"mt-2 px-4 py-1 bg-zinc-800 text-zinc-50 rounded-md cursor-pointer",onClick:()=>n(e),children:e})},e))})}function E(e){let{gameState:t,minesLeft:n}=e;return"win"===t?(0,l.jsx)("div",{children:"Wygrałeś!"}):"lose"===t?(0,l.jsx)("div",{children:"Koniec gry!"}):(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("img",{width:"40",height:"40",src:s.src}),n]})}let j={src:"/minesweeper/_next/static/media/timer.0c3779fb.svg"};function _(e){let{timeDiff:t}=e;return(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("img",{width:"40",height:"40",src:j.src}),t]})}function y(e){let{timeDiff:t,startNewGame:n,...i}=e;return(0,l.jsxs)("header",{className:"flex justify-between items-center py-2 font-bold text-md gap-1",children:[(0,l.jsx)(E,{...i}),(0,l.jsx)("button",{className:"px-3 py-1 bg-zinc-700 text-zinc-50 rounded-md cursor-pointer",onClick:n,children:"Nowa gra"}),(0,l.jsx)(_,{timeDiff:t})]})}function N(){let{board:e,minesLeft:t,level:n,setLevel:r,gameState:s,handleCellLeftClick:a,handleCellRightClick:o,timeDiff:m,startNewGame:v}=function(){let[e,t]=(0,i.useState)(f),n=u[e],[,l]=(0,i.useState)(0),[r,s]=(0,i.useState)(p(u[f].rows,u[f].cols,u[f].totalMines)),[a,o]=(0,i.useState)(""),{playSoundEffect:m}=function(){let[e,t]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!e){let e={};for(let t in d)e[t]=new Audio("".concat(location.pathname,"/sfx/").concat(d[t])),e[t].load();t(e)}}),{playSoundEffect:function(t){if(!e)return;let n=e[t];n.pause(),n.currentTime=0,n.play()}}}();function g(e,t){o(""),_(),l(0);let i=p(n.rows,n.cols,n.totalMines);if(e&&t){for(;"mine"===i[e][t].value;)i=p(n.rows,n.cols,n.totalMines);v(e,t)}s(i)}function v(t,n){N||E();let l=h(r),i=l[t][n],a="mine"===i.value,f=typeof i.value&&!!i.value,d=!i.value;if(a){if(!N)return void g(t,n);m("GAME_OVER"),i.isOpened=!0,o("lose"),i.hightlight="bg-[red]",b(l,!1)}else f?(m("REVEAL_NUMBER"),i.isOpened=!0):d&&(m("REVEAL_EMPTY"),function(e,t,n,l,i){let r=[[l,i]];for(;r.length>0;){let t=r.shift();if(!t)return;let[n,l]=t,i=e[n][l];if(i.isOpened=!0,!i.value)for(let[t,i]of c){let s=n+t,a=l+i;s in e&&a in e[0]&&!e[s][a].isOpened&&!e[s][a].isFlagged&&r.push([s,a])}}}(l,u[e].rows,u[e].cols,t,n)),function(e,t){let n=0;for(let t of e)for(let e of t)!e.isOpened&&n++;return 10===n}(l,0)&&(m("GAME_WIN"),b(r,!0),o("win"));s(l)}(0,i.useEffect)(()=>g(),[e]);let w=function(e){let t=0;for(let n of e)for(let e of n)"mine"===e.value&&t++,e.isFlagged&&t--;return t}(r),{startTimer:E,stopTimer:j,resetTimer:_,timeDiff:y,timerRunning:N}=function(){let e=function(){let e=(0,i.useState)(!1)[1];return()=>e(e=>!e)}(),[t,n]=(0,i.useState)(0),l=x()-t,r=Math.floor(l);function s(){n(x())}return(0,i.useEffect)(()=>{t&&setTimeout(e,(r-l+1)*1e3)}),{startTimer:s,stopTimer:function(){n(0)},resetTimer:function(){s(),setTimeout(()=>n(0))},timeDiff:r,timerRunning:!!t}}();return(0,i.useEffect)(()=>{""!==a&&j()}),{board:r,level:e,setLevel:t,gameState:a,handleCellLeftClick:function(e,t){"lose"===a||r[e][t].isOpened||r[e][t].isFlagged||v(e,t)},handleCellRightClick:function(e,t,n){e.preventDefault(),""===a&&!r[t][n].isOpened&&(0!==w||r[t][n].isFlagged)&&s(e=>{let i=h(e),r=i[t][n];return r.isFlagged,m("FLAG_REMOVE"),l(e=>r.isFlagged?-1:1+e),r.isFlagged=!r.isFlagged,i})},timeDiff:y,minesLeft:w,startNewGame:g}}(),[E,j]=(0,i.useState)(!1);if((0,i.useEffect)(()=>j(!0)),E)return(0,l.jsxs)("main",{className:"py-2 px-6 bg-[#ccc] rounded-2xl w-fit m-auto",children:[(0,l.jsx)(y,{gameState:s,minesLeft:t,timeDiff:m,startNewGame:v}),(0,l.jsx)(g,{board:e,level:n,handleCellLeftClick:a,handleCellRightClick:o}),(0,l.jsx)(w,{level:n,setLevel:r})]})}window.oncontextmenu=e=>e.preventDefault()}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(34)),_N_E=e.O()}]);