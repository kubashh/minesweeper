(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{34:(e,t,l)=>{Promise.resolve().then(l.bind(l,8846))},8846:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>A});var n=l(5155),i=l(2115);let r=function(){for(var e,t,l=0,n="",i=arguments.length;l<i;l++)(e=arguments[l])&&(t=function e(t){var l,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var r=t.length;for(l=0;l<r;l++)t[l]&&(n=e(t[l]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}(e))&&(n&&(n+=" "),n+=t);return n},a={src:"/minesweeper/_next/static/media/bomb.ffc243c2.svg"},s={src:"/minesweeper/_next/static/media/redFlag.1b491fbe.png"};function u(){return performance.now()/1e3}function o(e){return Math.floor(Math.random()*e)}function c(e,t,l){let n=function(e,t){let l=[];for(let n=0;n<e;n++){l[n]=[];for(let e=0;e<t;e++)l[n][e]={value:null,isFlagged:!1,isOpened:!1}}return l}(e,t);for(let i=0;i<l;){let l=o(e),r=o(t);"mine"!==n[l][r].value&&(n[l][r].value="mine",i++)}return n.forEach((e,t)=>{e.forEach((l,i)=>{if("mine"!==l.value){let r=0;h.forEach(l=>{let[a,s]=l,u=t+a,o=i+s;u in n&&o in e&&"mine"===n[u][o].value&&r++}),r>0&&(l.value=r)}})}),n}function f(e,t){for(let l of e)for(let e of l)"mine"===e.value&&(e.isOpened=!0,t&&(e.hightlight="bg-[green]"))}function d(){let e=(0,i.useState)(!1)[1];return()=>e(e=>!e)}class v{bind(){this.refresh=d()}get value(){return this.v}set value(e){var t;this.v=e,null==(t=this.refresh)||t.call(this)}constructor(e,t){this.v=e,t&&(this.refresh=t)}}let m=[null,"text-[blue]","text-[green]","text-[tomato]","text-[darkviolet]","text-[darkred]","text-[steelblue]","text-[black]","text-[black]"],h=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],g={easy:{rows:9,cols:9,totalMines:10},medium:{rows:16,cols:16,totalMines:40},expert:{rows:16,cols:30,totalMines:99}},x={REVEAL_EMPTY:"revealEmpty.wav",REVEAL_NUMBER:"revealNumber.wav",FLAG_PLACE:"flagPlace.wav",FLAG_REMOVE:"flagRemove.wav",GAME_OVER:"gameOver.wav",GAME_WIN:"gameWin.wav"},p=new v("playing"),b=new v("easy"),w=new v(u()),E=new v(0),y=new v(c(g[b.value].rows,g[b.value].cols,g[b.value].totalMines));function j(e){let{cell:t,rowIndex:l,colIndex:i,handleCellLeftClick:u,handleCellRightClick:o}=e;return(0,n.jsxs)("div",{className:r("w-9 h-9 border-1 border-zinc-600 flex justify-center items-center text-2xl font-bold cursor-default relative","number"==typeof t.value&&m[t.value],!t.isOpened&&"bg-[#ccc] border-3 border-t-[#eee] border-l-[#eee] border-r-[#aaa] border-b-[#aaa] shadow-sm","mine"===t.value&&t.hightlight,"easy"===b.value&&"w-16 h-16 text-4xl",!t.isOpened&&"cursor-pointer"),onClick:()=>u(l,i),onContextMenu:()=>o(l,i),children:[t.isOpened&&"number"==typeof t.value&&t.value||"",t.isOpened&&"mine"===t.value&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:a.src}),!t.isOpened&&t.isFlagged&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:s.src})]})}function O(e){let{handleCellLeftClick:t,handleCellRightClick:l}=e;return y.bind(),y.value.map((e,i)=>(0,n.jsx)("div",{className:"flex",children:e.map((e,r)=>(0,n.jsx)(j,{cell:e,handleCellLeftClick:t,handleCellRightClick:l,rowIndex:i,colIndex:r},r))},i))}function N(){return(0,n.jsx)("ul",{className:"flex justify-around",children:Object.keys(g).map(e=>(0,n.jsx)("li",{children:(0,n.jsx)("button",{className:"mt-2 px-4 py-1 bg-zinc-800 text-zinc-50 rounded-md cursor-pointer",onClick:()=>b.value=e,children:e})},e))})}function M(){return(p.bind(),"win"===p.value)?(0,n.jsx)("div",{children:"Wygrałeś!"}):"lose"===p.value?(0,n.jsx)("div",{children:"Koniec gry!"}):(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("img",{width:"40",height:"40",src:a.src}),E.value]})}let _={src:"/minesweeper/_next/static/media/timer.0c3779fb.svg"};function C(){return(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("img",{width:"40",height:"40",src:_.src}),w.value]})}function k(e){let{startNewGame:t}=e;return(0,n.jsxs)("header",{className:"flex justify-between items-center py-2 font-bold text-md gap-1",children:[(0,n.jsx)(M,{}),(0,n.jsx)("button",{className:"px-3 py-1 bg-zinc-700 text-zinc-50 rounded-md cursor-pointer",onClick:t,children:"Nowa gra"}),(0,n.jsx)(C,{})]})}function A(){b.bind();let{handleCellLeftClick:e,handleCellRightClick:t,startNewGame:l}=function(){let e=g[b.value],[,t]=(0,i.useState)(0),{playSoundEffect:l}=function(){let[e,t]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!e){let e={};for(let t in x)e[t]=new Audio("".concat(location.pathname,"/sfx/").concat(x[t])),e[t].load();t(e)}}),{playSoundEffect:function(t){if(!e)return;let l=e[t];l.pause(),l.currentTime=0,l.play()}}}();function n(l,n){p.value="playing",o(),t(0);let i=c(e.rows,e.cols,e.totalMines);if(l&&n){for(;"mine"===i[l][n].value;)i=c(e.rows,e.cols,e.totalMines);r(l,n)}y.value=i}function r(e,t){v||a();let i=y.value,r=i[e][t],s="mine"===r.value,u=typeof r.value&&!!r.value,o=!r.value;if(s){if(!v)return n(e,t);l("GAME_OVER"),r.isOpened=!0,p.value="lose",r.hightlight="bg-[red]",f(i,!1)}else u?(l("REVEAL_NUMBER"),r.isOpened=!0):o&&(l("REVEAL_EMPTY"),function(e,t,l){let n=[[t,l]];for(;n.length>0;){let t=n.shift();if(!t)return;let[l,i]=t,r=e[l][i];if(r.isOpened=!0,!r.value)for(let[t,r]of h){let a=l+t,s=i+r;a in e&&s in e[0]&&!e[a][s].isOpened&&!e[a][s].isFlagged&&n.push([a,s])}}}(i,e,t)),function(e,t){let l=0;for(let t of e)for(let e of t)!e.isOpened&&l++;return 10===l}(i,0)&&(l("GAME_WIN"),f(y.value,!0),p.value="win");y.value=i}(0,i.useEffect)(()=>n(),[b.value]),E.value=function(e){let t=0;for(let l of e)for(let e of l)"mine"===e.value&&t++,e.isFlagged&&t--;return t}(y.value);let{startTimer:a,stopTimer:s,resetTimer:o,timerRunning:v}=function(){let e=d(),[t,l]=(0,i.useState)(0),n=u()-t;function r(){l(u())}return t&&(w.value=Math.floor(n)),(0,i.useEffect)(()=>{t&&setTimeout(e,(w.value-n+1)*1e3)}),{startTimer:r,stopTimer:function(){l(0)},resetTimer:function(){r(),setTimeout(()=>l(0))},timerRunning:!!t}}();return(0,i.useEffect)(()=>{"playing"!==p.value&&s()}),{handleCellLeftClick:function(e,t){"lose"===p.value||y.value[e][t].isOpened||y.value[e][t].isFlagged||r(e,t)},handleCellRightClick:function(e,n){var i;if("playing"!==p.value||y.value[e][n].isOpened||0===E.value&&!y.value[e][n].isFlagged)return;let r=y.value[e][n];r.isFlagged,l("FLAG_REMOVE"),t(e=>r.isFlagged?-1:1+e),r.isFlagged=!r.isFlagged,null==(i=y.refresh)||i.call(y)},startNewGame:n}}(),[r,a]=(0,i.useState)(!1);if((0,i.useEffect)(()=>a(!0)),r)return(0,n.jsxs)("main",{className:"py-2 px-6 bg-[#ccc] rounded-2xl w-fit m-auto",children:[(0,n.jsx)(k,{startNewGame:l}),(0,n.jsx)(O,{handleCellLeftClick:e,handleCellRightClick:t}),(0,n.jsx)(N,{})]})}window.oncontextmenu=e=>e.preventDefault()}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(34)),_N_E=e.O()}]);