(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1475:(e,t,n)=>{Promise.resolve().then(n.bind(n,7248))},7248:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>B});var l=n(5155);let r={src:"/minesweeper/_next/static/media/bomb.ffc243c2.svg"};var i=n(2115);function a(){let e=(0,i.useState)(!1)[1];return()=>e(e=>!e)}class s{bind(e){if(e){let t=a();this.refresh=()=>{e(),t()}}else this.refresh=a()}get value(){return this.v}set value(e){var t;this.v=e,null==(t=this.refresh)||t.call(this)}constructor(e,t){this.v=e,t&&(this.refresh=a())}}let u={src:"/minesweeper/_next/static/media/timer.0c3779fb.svg"},o=0,c=!1;function f(e){return"".concat(e<10?"0":"").concat(e)}function v(){return F.bind(),(0,l.jsxs)("div",{className:"flex items-center text-2xl",children:[(0,l.jsx)("img",{width:"40",height:"40",src:u.src}),"".concat(f(Math.floor(F.value/60)),":").concat(f(F.value%60))]})}let d={REVEAL_EMPTY:"revealEmpty.wav",REVEAL_NUMBER:"revealNumber.wav",FLAG_PLACE:"flagPlace.wav",FLAG_REMOVE:"flagRemove.wav",GAME_OVER:"gameOver.wav",GAME_WIN:"gameWin.wav"},m={};for(let e in window.oncontextmenu=e=>e.preventDefault(),d)m[e]=new Audio("".concat(location.pathname,"/sfx/").concat(d[e])),m[e].load();function h(e){let t=m[e];t.pause(),t.currentTime=0,t.play()}function g(){return performance.now()/1e3}function x(e){return Math.floor(Math.random()*e)}function p(){let{rows:e,cols:t,totalMines:n}=M[A.value],l=function(){let{rows:e,cols:t}=M[A.value],n=[];for(let l=0;l<e;l++){n[l]=[];for(let e=0;e<t;e++)n[l][e]={value:0,isFlagged:!1,isOpened:!1}}return n}();for(let r=0;r<n;){let n=x(e),i=x(t);"mine"!==l[n][i].value&&(l[n][i].value="mine",r++)}return l.forEach((e,t)=>{e.forEach((n,r)=>{if("mine"!==n.value){let i=0;N.forEach(n=>{let[a,s]=n,u=t+a,o=r+s;u in l&&o in e&&"mine"===l[u][o].value&&i++}),i>0&&(n.value=i)}})}),l}function b(e){for(let t of z.value)for(let n of t)"mine"===n.value&&(n.isOpened=!0,e&&(n.hightlight="bg-[green]"))}function w(e){var t;let n=!c;if(c||function e(t){t||(c=!0,o=g());let n=g()-o;F.value=Math.floor(n),o||(F.value=0),c&&setTimeout(()=>e(!0),(F.value-n+1)*1e3)}(),"mine"===e.value){if(n)return j(e);h("GAME_OVER"),e.isOpened=!0,e.hightlight="bg-[red]",_.value="lose",b(!1)}else(e.value,e.value)?(h("REVEAL_NUMBER"),e.isOpened=!0):e.value||(h("REVEAL_EMPTY"),function(e){let t,n=[y(e)];for(;t=n.shift();){let[e,l]=t,r=z.value[e][l];if(r.isOpened=!0,!r.value)for(let[t,r]of N){let i=e+t,a=l+r;i in z.value&&a in z.value[0]&&!z.value[i][a].isOpened&&!z.value[i][a].isFlagged&&n.push([i,a])}}}(e)),function(){let e=0;for(let t of z.value)for(let n of t)!n.isOpened&&e++;return e===M[A.value].totalMines}()&&(h("GAME_WIN"),b(!0),_.value="win");null==(t=z.refresh)||t.call(z)}function E(){let e=0;for(let t of z.value)for(let n of t)"mine"===n.value&&e++,n.isFlagged&&e--;k.value=e}function j(e){if(e){let[t,n]=y(e);z.value=function(e,t){let n=p();for(;"mine"===n[e][t].value;)n=p();return n}(t,n),setTimeout(()=>w(z.value[t][n]))}else z.value=p();_.value="playing",o=0,c=!1,E()}function y(e){let{rows:t,cols:n}=M[A.value];for(let l=0;l<t;l++)for(let t=0;t<n;t++)if(z.value[l][t]===e)return[l,t];throw Error("No such cell!")}let O=[null,"text-[blue]","text-[green]","text-[tomato]","text-[darkviolet]","text-[darkred]","text-[steelblue]","text-[black]","text-[black]"],N=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],M={easy:{rows:9,cols:9,totalMines:10},medium:{rows:16,cols:16,totalMines:40},expert:{rows:16,cols:30,totalMines:99}},_=new s("playing"),A=new s("easy"),F=new s(0),k=new s(M.easy.totalMines),z=new s(p());function R(){return(k.bind(),_.bind(()=>{"playing"!==_.value&&(c=!1)}),"win"===_.value)?(0,l.jsx)("div",{children:"Wygrałeś!"}):"lose"===_.value?(0,l.jsx)("div",{children:"Koniec gry!"}):(0,l.jsxs)("div",{className:"flex items-center text-2xl",children:[(0,l.jsx)("img",{width:"40",height:"40",src:r.src}),k.value]})}function L(){return(0,l.jsxs)("header",{className:"flex justify-between items-center py-2 font-semibold text-md gap-1",children:[(0,l.jsx)(R,{}),(0,l.jsx)("button",{className:"px-3 py-1 bg-zinc-900 text-zinc-50 rounded-md cursor-pointer",onClick:()=>j(),children:"Nowa gra"}),(0,l.jsx)(v,{})]})}let V=function(){for(var e,t,n=0,l="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=function e(t){var n,l,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(l=e(t[n]))&&(r&&(r+=" "),r+=l)}else for(l in t)t[l]&&(r&&(r+=" "),r+=l);return r}(e))&&(l&&(l+=" "),l+=t);return l},C={src:"/minesweeper/_next/static/media/redFlag.1b491fbe.png"};function G(e){let{cell:t}=e;return(0,l.jsxs)("div",{className:V("w-9 h-9 border-1 border-zinc-600 flex justify-center items-center text-2xl font-bold cursor-default relative","number"==typeof t.value&&O[t.value],!t.isOpened&&"bg-zinc-300 border-3 border-t-zinc-200 border-l-zinc-200 border-r-zinc-400 border-b-zinc-400 shadow-sm",!t.isOpened&&"easy"===A.value&&"border-5","mine"===t.value&&t.hightlight,"easy"===A.value&&"w-16 h-16 text-4xl",!t.isOpened&&"cursor-pointer"),onClick:()=>{"lose"!==_.value&&!t.isOpened&&!t.isFlagged&&w(t)},onContextMenu:()=>{var e,n;return e=t,void("playing"===_.value&&!e.isOpened&&(0!==k.value||e.isFlagged)&&(e.isFlagged,h("FLAG_REMOVE"),e.isFlagged=!e.isFlagged,E(),null==(n=z.refresh)||n.call(z)))},children:[t.isOpened&&"number"==typeof t.value&&t.value||"",t.isOpened&&"mine"===t.value&&(0,l.jsx)("img",{className:"w-[80%] h-[80%]",src:r.src}),!t.isOpened&&t.isFlagged&&(0,l.jsx)("img",{className:"w-[80%] h-[80%]",src:C.src})]})}function P(){return z.bind(),z.value.map((e,t)=>(0,l.jsx)("div",{className:"flex",children:e.map((e,t)=>(0,l.jsx)(G,{cell:e},t))},t))}function T(){return(0,l.jsx)("ul",{className:"flex justify-around",children:Object.keys(M).map(e=>(0,l.jsx)("li",{children:(0,l.jsx)("button",{className:V("mt-2 px-4 py-1 text-zinc-50 font-semibold rounded-md cursor-pointer",A.value===e?"bg-zinc-700":"bg-zinc-900"),onClick:()=>A.value=e,children:e})},e))})}function W(){return A.bind(j),(0,l.jsxs)("main",{className:"py-2 px-6 bg-zinc-300 rounded-2xl w-fit m-auto",children:[(0,l.jsx)(L,{}),(0,l.jsx)(P,{}),(0,l.jsx)(T,{})]})}function B(){if(function(){let[e,t]=(0,i.useState)(!1);return(0,i.useEffect)(()=>t(!0),[e]),e}())return(0,l.jsx)(W,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(1475)),_N_E=e.O()}]);