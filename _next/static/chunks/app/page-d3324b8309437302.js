(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1475:(e,t,l)=>{Promise.resolve().then(l.bind(l,7248))},7248:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>B});var n=l(5155);let r={src:"/minesweeper/_next/static/media/bomb.ffc243c2.svg"};var a=l(2115);function i(){let e=(0,a.useState)(!1)[1];return()=>e(e=>!e)}class s{bind(e){if(e){let t=i();this.refresh=()=>{e(),t()}}else this.refresh=i()}get value(){return this.v}set value(e){var t;this.v=e,null==(t=this.refresh)||t.call(this)}constructor(e,t){this.v=e,t&&(this.refresh=i())}}let u={src:"/minesweeper/_next/static/media/timer.0c3779fb.svg"},o=0,c=!1;function f(e){return"".concat(e<10?"0":"").concat(e)}function v(){return F.bind(),(0,n.jsxs)("div",{className:"flex items-center text-2xl",children:[(0,n.jsx)("img",{width:"40",height:"40",src:u.src}),"".concat(f(Math.floor(F.value/60)),":").concat(f(F.value%60))]})}let d={REVEAL_EMPTY:"revealEmpty.wav",REVEAL_NUMBER:"revealNumber.wav",FLAG_PLACE:"flagPlace.wav",FLAG_REMOVE:"flagRemove.wav",GAME_OVER:"gameOver.wav",GAME_WIN:"gameWin.wav"},m={};for(let e in window.oncontextmenu=e=>e.preventDefault(),d)m[e]=new Audio("".concat(location.pathname,"/sfx/").concat(d[e])),m[e].load();function h(e){let t=m[e];t.pause(),t.currentTime=0,t.play()}function g(){return performance.now()/1e3}function x(e){return Math.floor(Math.random()*e)}function p(){let{rows:e,cols:t,totalMines:l}=M[A.value],n=function(){let{rows:e,cols:t}=M[A.value],l=[];for(let n=0;n<e;n++){l[n]=[];for(let e=0;e<t;e++)l[n][e]={value:0,isFlagged:!1,isOpened:!1}}return l}();for(let r=0;r<l;){let l=x(e),a=x(t);"mine"!==n[l][a].value&&(n[l][a].value="mine",r++)}return n.forEach((e,t)=>{e.forEach((l,r)=>{if("mine"!==l.value){let a=0;N.forEach(l=>{let[i,s]=l,u=t+i,o=r+s;u in n&&o in e&&"mine"===n[u][o].value&&a++}),a>0&&(l.value=a)}})}),n}function b(e){for(let t of R.value)for(let l of t)"mine"===l.value&&(l.isOpened=!0,e&&(l.hightlight="bg-[green]"))}function w(e){var t;let l=!c;if(c||function e(t){t||(c=!0,o=g());let l=g()-o;F.value=Math.floor(l),o||(F.value=0),c&&setTimeout(()=>e(!0),(F.value-l+1)*1e3)}(),"mine"===e.value){if(l)return j(e);h("GAME_OVER"),e.isOpened=!0,e.hightlight="bg-[red]",_.value="lose",b(!1)}else(e.value,e.value)?(h("REVEAL_NUMBER"),e.isOpened=!0):e.value||(h("REVEAL_EMPTY"),function(e){let t,l=[y(e)];for(;t=l.shift();){let[e,n]=t,r=R.value[e][n];if(r.isOpened=!0,!r.value)for(let[t,r]of N){let a=e+t,i=n+r;a in R.value&&i in R.value[0]&&!R.value[a][i].isOpened&&!R.value[a][i].isFlagged&&l.push([a,i])}}}(e)),function(){let e=0;for(let t of R.value)for(let l of t)!l.isOpened&&e++;return e===M[A.value].totalMines}()&&(h("GAME_WIN"),b(!0),_.value="win");null==(t=R.refresh)||t.call(R)}function E(){let e=0;for(let t of R.value)for(let l of t)"mine"===l.value&&e++,l.isFlagged&&e--;k.value=e}function j(e){if(e){let[t,l]=y(e);R.value=function(e,t){let l=p();for(;"mine"===l[e][t].value;)l=p();return l}(t,l),setTimeout(()=>w(R.value[t][l]))}else R.value=p();_.value="playing",o=0,c=!1,E()}function y(e){let{rows:t,cols:l}=M[A.value];for(let n=0;n<t;n++)for(let t=0;t<l;t++)if(R.value[n][t]===e)return[n,t];throw Error("No such cell!")}let O=[null,"text-[blue]","text-[green]","text-[tomato]","text-[darkviolet]","text-[darkred]","text-[steelblue]","text-[black]","text-[black]"],N=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],M={easy:{rows:9,cols:9,totalMines:10},medium:{rows:16,cols:16,totalMines:40},expert:{rows:16,cols:30,totalMines:99}},_=new s("playing"),A=new s("easy"),F=new s(0),k=new s(M.easy.totalMines),R=new s(p());function L(){return(k.bind(),_.bind(()=>{"playing"!==_.value&&(c=!1)}),"win"===_.value)?(0,n.jsx)("div",{children:"Wygrałeś!"}):"lose"===_.value?(0,n.jsx)("div",{children:"Koniec gry!"}):(0,n.jsxs)("div",{className:"flex items-center text-2xl",children:[(0,n.jsx)("img",{width:"40",height:"40",src:r.src}),k.value]})}function V(){return(0,n.jsxs)("header",{className:"flex justify-between items-center py-2 font-semibold text-md gap-1",children:[(0,n.jsx)(L,{}),(0,n.jsx)("button",{className:"px-3 py-1 bg-zinc-900 text-zinc-50 rounded-md cursor-pointer",onClick:()=>j(),children:"Nowa gra"}),(0,n.jsx)(v,{})]})}let C=function(){for(var e,t,l=0,n="",r=arguments.length;l<r;l++)(e=arguments[l])&&(t=function e(t){var l,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var a=t.length;for(l=0;l<a;l++)t[l]&&(n=e(t[l]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}(e))&&(n&&(n+=" "),n+=t);return n},G={src:"/minesweeper/_next/static/media/redFlag.1b491fbe.png"};function z(e){let{cell:t}=e;return(0,n.jsxs)("div",{className:C("w-9 h-9 border-1 border-zinc-600 flex justify-center items-center text-2xl font-bold cursor-default relative","number"==typeof t.value&&O[t.value],!t.isOpened&&"bg-[#ccc] border-3 border-t-[#eee] border-l-[#eee] border-r-[#aaa] border-b-[#aaa] shadow-sm",!t.isOpened&&"easy"===A.value&&"border-5","mine"===t.value&&t.hightlight,"easy"===A.value&&"w-16 h-16 text-4xl",!t.isOpened&&"cursor-pointer"),onClick:()=>{"lose"!==_.value&&!t.isOpened&&!t.isFlagged&&w(t)},onContextMenu:()=>{var e,l;return e=t,void("playing"===_.value&&!e.isOpened&&(0!==k.value||e.isFlagged)&&(e.isFlagged,h("FLAG_REMOVE"),e.isFlagged=!e.isFlagged,E(),null==(l=R.refresh)||l.call(R)))},children:[t.isOpened&&"number"==typeof t.value&&t.value||"",t.isOpened&&"mine"===t.value&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:r.src}),!t.isOpened&&t.isFlagged&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:G.src})]})}function P(){return R.bind(),R.value.map((e,t)=>(0,n.jsx)("div",{className:"flex",children:e.map((e,t)=>(0,n.jsx)(z,{cell:e},t))},t))}function T(){return(0,n.jsx)("ul",{className:"flex justify-around",children:Object.keys(M).map(e=>(0,n.jsx)("li",{children:(0,n.jsx)("button",{className:C("mt-2 px-4 py-1 text-zinc-50 font-semibold rounded-md cursor-pointer",A.value===e?"bg-zinc-700":"bg-zinc-900"),onClick:()=>A.value=e,children:e})},e))})}function W(){return A.bind(j),(0,n.jsxs)("main",{className:"py-2 px-6 bg-[#ccc] rounded-2xl w-fit m-auto",children:[(0,n.jsx)(V,{}),(0,n.jsx)(P,{}),(0,n.jsx)(T,{})]})}function B(){if(function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>t(!0),[e]),e}())return(0,n.jsx)(W,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(1475)),_N_E=e.O()}]);