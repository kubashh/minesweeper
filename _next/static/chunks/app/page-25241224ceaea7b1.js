(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{34:(e,t,l)=>{Promise.resolve().then(l.bind(l,3995))},3995:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>P});var n=l(5155),r=l(2115);let a=function(){for(var e,t,l=0,n="",r=arguments.length;l<r;l++)(e=arguments[l])&&(t=function e(t){var l,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var a=t.length;for(l=0;l<a;l++)t[l]&&(n=e(t[l]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}(e))&&(n&&(n+=" "),n+=t);return n},i={src:"/minesweeper/_next/static/media/bomb.ffc243c2.svg"},s={src:"/minesweeper/_next/static/media/redFlag.1b491fbe.png"};function u(){let e=(0,r.useState)(!1)[1];return()=>e(e=>!e)}class o{bind(e){if(e){let t=u();this.refresh=()=>{e(),t()}}else this.refresh=u()}get value(){return this.v}set value(e){var t;this.v=e,null==(t=this.refresh)||t.call(this)}constructor(e,t){this.v=e,t&&(this.refresh=t)}}let c={src:"/minesweeper/_next/static/media/timer.0c3779fb.svg"},f=0,v=!1;function d(){return F.bind(),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("img",{width:"40",height:"40",src:c.src}),F.value]})}let m={REVEAL_EMPTY:"revealEmpty.wav",REVEAL_NUMBER:"revealNumber.wav",FLAG_PLACE:"flagPlace.wav",FLAG_REMOVE:"flagRemove.wav",GAME_OVER:"gameOver.wav",GAME_WIN:"gameWin.wav"},h={};for(let e in window.oncontextmenu=e=>e.preventDefault(),m)h[e]=new Audio("".concat(location.pathname,"/sfx/").concat(m[e])),h[e].load();function g(e){let t=h[e];t.pause(),t.currentTime=0,t.play()}function x(){return performance.now()/1e3}function p(e){return Math.floor(Math.random()*e)}function b(e,t,l){let n=function(e,t){let l=[];for(let n=0;n<e;n++){l[n]=[];for(let e=0;e<t;e++)l[n][e]={value:null,isFlagged:!1,isOpened:!1}}return l}(e,t);for(let r=0;r<l;){let l=p(e),a=p(t);"mine"!==n[l][a].value&&(n[l][a].value="mine",r++)}return n.forEach((e,t)=>{e.forEach((l,r)=>{if("mine"!==l.value){let a=0;M.forEach(l=>{let[i,s]=l,u=t+i,o=r+s;u in n&&o in e&&"mine"===n[u][o].value&&a++}),a>0&&(l.value=a)}})}),n}function w(e){for(let t of R.value)for(let l of t)"mine"===l.value&&(l.isOpened=!0,e&&(l.hightlight="bg-[green]"))}function E(){let e=0;for(let t of R.value)for(let l of t)"mine"===l.value&&e++,l.isFlagged&&e--;k.value=e}function y(e,t){let l=N[A.value];_.value="playing",f=0,v=!1;let n=b(l.rows,l.cols,l.totalMines);if(e&&t){for(;"mine"===n[e][t].value;)n=b(l.rows,l.cols,l.totalMines);j(e,t)}R.value=n,E()}function j(e,t){var l;let n=!v;v||function e(t){t||(v=!0,f=x());let l=x()-f;F.value=Math.floor(l),f||(F.value=0),v&&setTimeout(()=>e(!0),(F.value-l+1)*1e3)}();let r=R.value[e][t],a="mine"===r.value,i=typeof r.value&&!!r.value,s=!r.value;if(a){if(n)return y(e,t);g("GAME_OVER"),r.isOpened=!0,_.value="lose",r.hightlight="bg-[red]",w(!1)}else i?(g("REVEAL_NUMBER"),r.isOpened=!0):s&&(g("REVEAL_EMPTY"),function(e,t){let l=[[e,t]];for(;l.length>0;){let e=l.shift();if(!e)return;let[t,n]=e,r=R.value[t][n];if(r.isOpened=!0,!r.value)for(let[e,r]of M){let a=t+e,i=n+r;a in R.value&&i in R.value[0]&&!R.value[a][i].isOpened&&!R.value[a][i].isFlagged&&l.push([a,i])}}}(e,t)),function(e){let t=0;for(let e of R.value)for(let l of e)!l.isOpened&&t++;return 10===t}(0)&&(g("GAME_WIN"),w(!0),_.value="win");null==(l=R.refresh)||l.call(R)}let O=[null,"text-[blue]","text-[green]","text-[tomato]","text-[darkviolet]","text-[darkred]","text-[steelblue]","text-[black]","text-[black]"],M=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],N={easy:{rows:9,cols:9,totalMines:10},medium:{rows:16,cols:16,totalMines:40},expert:{rows:16,cols:30,totalMines:99}},_=new o("playing"),A=new o("easy"),F=new o(0),k=new o(0),R=new o(b(N[A.value].rows,N[A.value].cols,N[A.value].totalMines));function L(e){let{cell:t,rowIndex:l,colIndex:r}=e;return(0,n.jsxs)("div",{className:a("w-9 h-9 border-1 border-zinc-600 flex justify-center items-center text-2xl font-bold cursor-default relative","number"==typeof t.value&&O[t.value],!t.isOpened&&"bg-[#ccc] border-3 border-t-[#eee] border-l-[#eee] border-r-[#aaa] border-b-[#aaa] shadow-sm",!t.isOpened&&"easy"===A.value&&"border-5","mine"===t.value&&t.hightlight,"easy"===A.value&&"w-16 h-16 text-4xl",!t.isOpened&&"cursor-pointer"),onClick:()=>{"lose"!==_.value&&!R.value[l][r].isOpened&&!R.value[l][r].isFlagged&&j(l,r)},onContextMenu:()=>(function(e,t){var l;if("playing"!==_.value||R.value[e][t].isOpened||0===k.value&&!R.value[e][t].isFlagged)return;let n=R.value[e][t];n.isFlagged,g("FLAG_REMOVE"),n.isFlagged=!n.isFlagged,E(),null==(l=R.refresh)||l.call(R)})(l,r),children:[t.isOpened&&"number"==typeof t.value&&t.value||"",t.isOpened&&"mine"===t.value&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:i.src}),!t.isOpened&&t.isFlagged&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:s.src})]})}function V(){return R.bind(),R.value.map((e,t)=>(0,n.jsx)("div",{className:"flex",children:e.map((e,l)=>(0,n.jsx)(L,{cell:e,rowIndex:t,colIndex:l},l))},t))}function C(){return(0,n.jsx)("ul",{className:"flex justify-around",children:Object.keys(N).map(e=>(0,n.jsx)("li",{children:(0,n.jsx)("button",{className:"mt-2 px-4 py-1 bg-zinc-800 text-zinc-50 rounded-md cursor-pointer",onClick:()=>A.value=e,children:e})},e))})}function G(){return(k.bind(),_.bind(()=>{"playing"!==_.value&&(v=!1)}),"win"===_.value)?(0,n.jsx)("div",{children:"Wygrałeś!"}):"lose"===_.value?(0,n.jsx)("div",{children:"Koniec gry!"}):(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("img",{width:"40",height:"40",src:i.src}),k.value]})}function z(){return(0,n.jsxs)("header",{className:"flex justify-between items-center py-2 font-bold text-md gap-1",children:[(0,n.jsx)(G,{}),(0,n.jsx)("button",{className:"px-3 py-1 bg-zinc-700 text-zinc-50 rounded-md cursor-pointer",onClick:()=>y(),children:"Nowa gra"}),(0,n.jsx)(d,{})]})}function P(){A.bind(y);let[e,t]=(0,r.useState)(!1);if((0,r.useEffect)(()=>t(!0)),e)return(0,n.jsxs)("main",{className:"py-2 px-6 bg-[#ccc] rounded-2xl w-fit m-auto",children:[(0,n.jsx)(z,{}),(0,n.jsx)(V,{}),(0,n.jsx)(C,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(34)),_N_E=e.O()}]);