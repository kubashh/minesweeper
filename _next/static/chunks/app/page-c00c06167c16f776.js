(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{34:(e,l,t)=>{Promise.resolve().then(t.bind(t,3995))},3995:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>G});var n=t(5155),a=t(2115);let i=function(){for(var e,l,t=0,n="",a=arguments.length;t<a;t++)(e=arguments[t])&&(l=function e(l){var t,n,a="";if("string"==typeof l||"number"==typeof l)a+=l;else if("object"==typeof l)if(Array.isArray(l)){var i=l.length;for(t=0;t<i;t++)l[t]&&(n=e(l[t]))&&(a&&(a+=" "),a+=n)}else for(n in l)l[n]&&(a&&(a+=" "),a+=n);return a}(e))&&(n&&(n+=" "),n+=l);return n},r={src:"/minesweeper/_next/static/media/bomb.ffc243c2.svg"},s={src:"/minesweeper/_next/static/media/redFlag.1b491fbe.png"};function u(){return performance.now()/1e3}function o(e){return Math.floor(Math.random()*e)}function c(e,l,t){let n=function(e,l){let t=[];for(let n=0;n<e;n++){t[n]=[];for(let e=0;e<l;e++)t[n][e]={value:null,isFlagged:!1,isOpened:!1}}return t}(e,l);for(let a=0;a<t;){let t=o(e),i=o(l);"mine"!==n[t][i].value&&(n[t][i].value="mine",a++)}return n.forEach((e,l)=>{e.forEach((t,a)=>{if("mine"!==t.value){let i=0;j.forEach(t=>{let[r,s]=t,u=l+r,o=a+s;u in n&&o in e&&"mine"===n[u][o].value&&i++}),i>0&&(t.value=i)}})}),n}function f(e){for(let l of C.value)for(let t of l)"mine"===t.value&&(t.isOpened=!0,e&&(t.hightlight="bg-[green]"))}function d(){let e=0;for(let l of C.value)for(let t of l)"mine"===t.value&&e++,t.isFlagged&&e--;_.value=e}let v={src:"/minesweeper/_next/static/media/timer.0c3779fb.svg"},h=0,m=!1;function g(){return M.bind(),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("img",{width:"40",height:"40",src:v.src}),M.value]})}let x={REVEAL_EMPTY:"revealEmpty.wav",REVEAL_NUMBER:"revealNumber.wav",FLAG_PLACE:"flagPlace.wav",FLAG_REMOVE:"flagRemove.wav",GAME_OVER:"gameOver.wav",GAME_WIN:"gameWin.wav"},p={};function b(e){let l=p[e];l.pause(),l.currentTime=0,l.play()}for(let e in x)p[e]=new Audio("".concat(location.pathname,"/sfx/").concat(x[e])),p[e].load();class w{bind(){this.refresh=function(){let e=(0,a.useState)(!1)[1];return()=>e(e=>!e)}()}get value(){return this.v}set value(e){var l;this.v=e,null==(l=this.refresh)||l.call(this)}constructor(e,l){this.v=e,l&&(this.refresh=l)}}let E=[null,"text-[blue]","text-[green]","text-[tomato]","text-[darkviolet]","text-[darkred]","text-[steelblue]","text-[black]","text-[black]"],j=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],y={easy:{rows:9,cols:9,totalMines:10},medium:{rows:16,cols:16,totalMines:40},expert:{rows:16,cols:30,totalMines:99}},O=new w("playing"),N=new w("easy"),M=new w(0),_=new w(0),C=new w(c(y[N.value].rows,y[N.value].cols,y[N.value].totalMines));function k(e){let{cell:l,rowIndex:t,colIndex:a,handleCellLeftClick:u,handleCellRightClick:o}=e;return(0,n.jsxs)("div",{className:i("w-9 h-9 border-1 border-zinc-600 flex justify-center items-center text-2xl font-bold cursor-default relative","number"==typeof l.value&&E[l.value],!l.isOpened&&"bg-[#ccc] border-3 border-t-[#eee] border-l-[#eee] border-r-[#aaa] border-b-[#aaa] shadow-sm","mine"===l.value&&l.hightlight,"easy"===N.value&&"w-16 h-16 text-4xl",!l.isOpened&&"cursor-pointer"),onClick:()=>u(t,a),onContextMenu:()=>o(t,a),children:[l.isOpened&&"number"==typeof l.value&&l.value||"",l.isOpened&&"mine"===l.value&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:r.src}),!l.isOpened&&l.isFlagged&&(0,n.jsx)("img",{className:"w-[80%] h-[80%]",src:s.src})]})}function A(e){let{handleCellLeftClick:l,handleCellRightClick:t}=e;return C.bind(),C.value.map((e,a)=>(0,n.jsx)("div",{className:"flex",children:e.map((e,i)=>(0,n.jsx)(k,{cell:e,handleCellLeftClick:l,handleCellRightClick:t,rowIndex:a,colIndex:i},i))},a))}function R(){return(0,n.jsx)("ul",{className:"flex justify-around",children:Object.keys(y).map(e=>(0,n.jsx)("li",{children:(0,n.jsx)("button",{className:"mt-2 px-4 py-1 bg-zinc-800 text-zinc-50 rounded-md cursor-pointer",onClick:()=>N.value=e,children:e})},e))})}function F(){return(_.bind(),O.bind(),"win"===O.value)?(0,n.jsx)("div",{children:"Wygrałeś!"}):"lose"===O.value?(0,n.jsx)("div",{children:"Koniec gry!"}):(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("img",{width:"40",height:"40",src:r.src}),_.value]})}function L(e){let{startNewGame:l}=e;return(0,n.jsxs)("header",{className:"flex justify-between items-center py-2 font-bold text-md gap-1",children:[(0,n.jsx)(F,{}),(0,n.jsx)("button",{className:"px-3 py-1 bg-zinc-700 text-zinc-50 rounded-md cursor-pointer",onClick:l,children:"Nowa gra"}),(0,n.jsx)(g,{})]})}function G(){N.bind();let{handleCellLeftClick:e,handleCellRightClick:l,startNewGame:t}=function(){let e=y[N.value];function l(l,n){O.value="playing",h=0,m=!1;let a=c(e.rows,e.cols,e.totalMines);if(l&&n){for(;"mine"===a[l][n].value;)a=c(e.rows,e.cols,e.totalMines);t(l,n)}C.value=a,d()}function t(e,t){var n;let a=!m;m||function e(l){l||(m=!0,h=u());let t=u()-h;M.value=Math.floor(t),h||(M.value=0),m&&setTimeout(()=>e(!0),(M.value-t+1)*1e3)}();let i=C.value[e][t],r="mine"===i.value,s=typeof i.value&&!!i.value,o=!i.value;if(r){if(a)return l(e,t);b("GAME_OVER"),i.isOpened=!0,O.value="lose",i.hightlight="bg-[red]",f(!1)}else s?(b("REVEAL_NUMBER"),i.isOpened=!0):o&&(b("REVEAL_EMPTY"),function(e,l){let t=[[e,l]];for(;t.length>0;){let e=t.shift();if(!e)return;let[l,n]=e,a=C.value[l][n];if(a.isOpened=!0,!a.value)for(let[e,a]of j){let i=l+e,r=n+a;i in C.value&&r in C.value[0]&&!C.value[i][r].isOpened&&!C.value[i][r].isFlagged&&t.push([i,r])}}}(e,t)),function(e){let l=0;for(let e of C.value)for(let t of e)!t.isOpened&&l++;return 10===l}(0)&&(b("GAME_WIN"),f(!0),O.value="win");null==(n=C.refresh)||n.call(C)}return(0,a.useEffect)(()=>l(),[N.value]),(0,a.useEffect)(()=>{"playing"!==O.value&&(m=!1)}),{handleCellLeftClick:function(e,l){"lose"===O.value||C.value[e][l].isOpened||C.value[e][l].isFlagged||t(e,l)},handleCellRightClick:function(e,l){var t;if("playing"!==O.value||C.value[e][l].isOpened||0===_.value&&!C.value[e][l].isFlagged)return;let n=C.value[e][l];n.isFlagged,b("FLAG_REMOVE"),n.isFlagged=!n.isFlagged,d(),null==(t=C.refresh)||t.call(C)},startNewGame:l}}(),[i,r]=(0,a.useState)(!1);if((0,a.useEffect)(()=>r(!0)),i)return(0,n.jsxs)("main",{className:"py-2 px-6 bg-[#ccc] rounded-2xl w-fit m-auto",children:[(0,n.jsx)(L,{startNewGame:t}),(0,n.jsx)(A,{handleCellLeftClick:e,handleCellRightClick:l}),(0,n.jsx)(R,{})]})}window.oncontextmenu=e=>e.preventDefault()}},e=>{var l=l=>e(e.s=l);e.O(0,[441,684,358],()=>l(34)),_N_E=e.O()}]);