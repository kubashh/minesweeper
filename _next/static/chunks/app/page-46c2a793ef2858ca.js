(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{34:(e,t,n)=>{Promise.resolve().then(n.bind(n,7941))},7941:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>N});var l=n(5155),r=n(2115);let i=function(){for(var e,t,n=0,l="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=function e(t){var n,l,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(l=e(t[n]))&&(r&&(r+=" "),r+=l)}else for(l in t)t[l]&&(r&&(r+=" "),r+=l);return r}(e))&&(l&&(l+=" "),l+=t);return l},s={src:"/minesweeper/_next/static/media/bomb.ffc243c2.svg"},a={src:"/minesweeper/_next/static/media/red-flag.1b491fbe.png"},o=[null,"text-[blue]","text-[green]","text-[tomato]","text-[darkviolet]","text-[darkred]","text-[steelblue]","text-[black]","text-[black]"],c=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],u={easy:{rows:9,cols:9,totalMines:10},medium:{rows:16,cols:16,totalMines:40},expert:{rows:16,cols:30,totalMines:99}},f="easy",d={REVEAL_EMPTY:"reveal_empty.wav",REVEAL_NUMBER:"reveal_number.wav",FLAG_PLACE:"flag_place.wav",FLAG_REMOVE:"flag_remove.wav",GAME_OVER:"game_over.wav",GAME_WIN:"game_win.wav"};function m(e){let{cell:t,rowIndex:n,colIndex:r,level:c,handleCellLeftClick:u,handleCellRightClick:f}=e;return(0,l.jsxs)("div",{className:i("w-8 h-8 border-1 border-zinc-600 flex justify-center items-center text-2xl font-bold cursor-default relative","number"==typeof t.value&&o[t.value],!t.isOpened&&"bg-[#ccc] border-3 border-t-[#eee] border-l-[#eee] border-r-[#aaa] border-b-[#aaa] shadow-sm","mine"===t.value&&t.hightlight,"easy"===c&&"w-12 h-12 text-4xl",!t.isOpened&&"cursor-pointer"),onClick:()=>u(n,r),onContextMenu:e=>f(e,n,r),children:[t.isOpened&&"number"==typeof t.value&&t.value||"",t.isOpened&&"mine"===t.value&&(0,l.jsx)("img",{className:"w-[80%] h-[80%]",src:s.src}),t.isFlagged&&(0,l.jsx)("img",{className:"w-[80%] h-[80%]",src:a.src})]})}function g(e){let{board:t,level:n,handleCellLeftClick:r,handleCellRightClick:i}=e,s=0;return(0,l.jsx)("div",{children:t.map((e,t)=>(s++,(0,l.jsx)("div",{className:"flex",children:e.map((e,a)=>(s++,(0,l.jsx)(m,{cell:e,handleCellLeftClick:r,handleCellRightClick:i,rowIndex:t,colIndex:a,level:n},s)))},s)))})}function h(e){return JSON.parse(JSON.stringify(e))}function x(){return performance.now()/1e3}function p(e){return Math.floor(Math.random()*e)}function v(e,t,n){let l=function(e,t){let n=[];for(let l=0;l<e;l++){n[l]=[];for(let e=0;e<t;e++)n[l][e]={value:null,isFlagged:!1,isOpened:!1}}return n}(e,t);for(let r=0;r<n;){let n=p(e),i=p(t);"mine"!==l[n][i].value&&(l[n][i].value="mine",r++)}return l.forEach((e,t)=>{e.forEach((n,r)=>{if("mine"!==n.value){let i=0;c.forEach(n=>{let[s,a]=n,o=t+s,c=r+a;o in l&&c in e&&"mine"===l[o][c].value&&i++}),i>0&&(n.value=i)}})}),l}function b(e,t){for(let n of e)for(let e of n)"mine"===e.value&&(e.isOpened=!0,t&&(e.hightlight="bg-[green]"))}function w(e){let{level:t,setLevel:n}=e;return(0,l.jsx)("ul",{className:"flex justify-around",children:Object.keys(u).map(e=>(0,l.jsx)("li",{children:(0,l.jsx)("button",{className:"mt-2 px-4 py-1 bg-zinc-800 text-zinc-50 rounded-md cursor-pointer",onClick:()=>n(e),children:e})},e))})}function E(e){let{gameState:t,minesLeft:n}=e;return"win"===t?(0,l.jsx)("div",{children:"Wygrałeś!"}):"lose"===t?(0,l.jsx)("div",{children:"Koniec gry!"}):(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("img",{width:"40",height:"40",src:s.src}),n]})}let j={src:"/minesweeper/_next/static/media/timer.0c3779fb.svg"};function _(e){let{timeDiff:t}=e;return(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("img",{width:"40",height:"40",src:j.src}),t]})}function y(e){let{timeDiff:t,startNewGame:n,...r}=e;return(0,l.jsxs)("header",{className:"flex justify-between items-center py-2 font-bold text-md gap-1",children:[(0,l.jsx)(E,{...r}),(0,l.jsx)("button",{className:"px-3 py-1 bg-zinc-700 text-zinc-50 rounded-md cursor-pointer",onClick:n,children:"Nowa gra"}),(0,l.jsx)(_,{timeDiff:t})]})}function N(){let{board:e,minesLeft:t,level:n,setLevel:i,gameState:s,handleCellLeftClick:a,handleCellRightClick:o,timeDiff:m,startNewGame:p}=function(){let[e,t]=(0,r.useState)(f),n=u[e],[,l]=(0,r.useState)(0),[i,s]=(0,r.useState)(v(u[f].rows,u[f].cols,u[f].totalMines)),[a,o]=(0,r.useState)(""),{playSoundEffect:m}=function(){let[e,t]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!e){let e={};for(let t in d)e[t]=new Audio("".concat(location.pathname,"/sfx/").concat(d[t])),e[t].load();t(e)}}),{playSoundEffect:function(t){if(!e)return;let n=e[t];n.pause(),n.currentTime=0,n.play()}}}();function g(){o(""),j(),l(0),s(v(n.rows,n.cols,n.totalMines))}(0,r.useEffect)(()=>g(),[e]);let p=function(e){let t=0;for(let n of e)for(let e of n)"mine"===e.value&&t++,e.isFlagged&&t--;return t}(i),{startTimer:w,stopTimer:E,resetTimer:j,timeDiff:_,timerRunning:y}=function(){let e=function(){let e=(0,r.useState)(!1)[1];return()=>e(e=>!e)}(),[t,n]=(0,r.useState)(0),l=x()-t,i=Math.floor(l);function s(){n(x())}return(0,r.useEffect)(()=>{t&&setTimeout(e,(i-l+1)*1e3)}),{startTimer:s,stopTimer:function(){n(0)},resetTimer:function(){s(),setTimeout(()=>n(0))},timeDiff:i,timerRunning:!!t}}();return(0,r.useEffect)(()=>{""!==a&&E()}),{board:i,level:e,setLevel:t,gameState:a,handleCellLeftClick:function t(n,l){if("lose"===a||i[n][l].isOpened||i[n][l].isFlagged)return;y||w();let r=h(i),f=r[n][l],d="mine"===f.value,x=typeof f.value&&!!f.value,p=!f.value;if(d){if(!y){g(),t(n,l);return}m("GAME_OVER"),f.isOpened=!0,o("lose"),f.hightlight="bg-[red]",b(r,!1)}else x?(m("REVEAL_NUMBER"),f.isOpened=!0):p&&(m("REVEAL_EMPTY"),function(e,t,n,l,r){let i=[[l,r]];for(;i.length>0;){let t=i.shift();if(!t)return;let[n,l]=t,r=e[n][l];if(r.isOpened=!0,!r.value)for(let[t,r]of c){let s=n+t,a=l+r;s in e&&a in e[0]&&!e[s][a].isOpened&&!e[s][a].isFlagged&&i.push([s,a])}}}(r,u[e].rows,u[e].cols,n,l)),function(e,t){let n=0;for(let t of e)for(let e of t)!e.isOpened&&n++;return 10===n}(r,0)&&(m("GAME_WIN"),b(i,!0),o("win"));s(r)},handleCellRightClick:function(e,t,n){e.preventDefault(),""===a&&!i[t][n].isOpened&&(0!==p||i[t][n].isFlagged)&&s(e=>{let r=h(e),i=r[t][n];return i.isFlagged,m("FLAG_REMOVE"),l(e=>i.isFlagged?-1:1+e),i.isFlagged=!i.isFlagged,r})},timeDiff:_,minesLeft:p,startNewGame:g}}(),[E,j]=(0,r.useState)(!1);if((0,r.useEffect)(()=>j(!0)),E)return(0,l.jsxs)("main",{className:"py-2 px-6 bg-[#ccc] rounded-2xl w-fit m-auto",children:[(0,l.jsx)(y,{gameState:s,minesLeft:t,timeDiff:m,startNewGame:p}),(0,l.jsx)(g,{board:e,level:n,handleCellLeftClick:a,handleCellRightClick:o}),(0,l.jsx)(w,{level:n,setLevel:i})]})}window.oncontextmenu=e=>e.preventDefault()}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(34)),_N_E=e.O()}]);